<!--

    Skill Circuits
    Copyright (C) 2022 - Delft University of Technology

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as
    published by the Free Software Foundation, either version 3 of the
    License, or (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see <https://www.gnu.org/licenses/>.

-->
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{container}">
<head>
    <link rel="stylesheet" th:href="@{/css/blocks.css}">

    <title th:text="${edition.name}"></title>
</head>

<body>

<div layout:fragment="content">

    <form method="post" id="publish-edition-form" th:action="@{|/edition/${edition.id}/publish|}"
          th:if="${@authorisationService.canPublishEdition(edition.id)}">
        <button name="publish" id="publishEdition"
                th:if="!${@editionRepository.findByIdOrThrow(edition.id).isVisible()}"
                class="fa-solid btn-publish" title="publish" type="submit">
            Publish
        </button>
    </form>
    <form method="post" id="unpublish-edition-form" th:action="@{|/edition/${edition.id}/unpublish|}"
          th:if="${@authorisationService.canPublishEdition(edition.id)}">
        <button name="unpublish" id="unpublishEdition"
                th:if="${@editionRepository.findByIdOrThrow(edition.id).isVisible()}"
                class="fa-solid btn-unpublish" title="unpublish" type="submit">
            Unpublish
        </button>
    </form>

    <h1 th:text="${edition.course.name}"></h1>
    <h1 th:text="${edition.name}"></h1>

    <div class="blocks">
                <a class="block" th:each="module : ${edition.modules}" th:href="@{|/module/${module.id}|}">
                    <h2 th:text="${module.name}"></h2>
                </a>
    </div>
    <div class="blocks" id="blocks">

        <th:block th:each="module: ${edition.modules}">
            <div layout:replace="~{module/block :: moduleblock}"></div>
        </th:block>


        <div th:if="${@authorisationService.canCreateModuleInEdition(edition.id)}"
            class="ghost_block fa-solid fa-plus">
        </div>


        <div layout:replace="~{module/create :: form}"></div>
        <div layout:replace="~{module/delete :: overlay}"></div>
        <div layout:replace="~{module/edit :: form}"></div>

    </div>

    <div layout:replace="~{module/create :: script}"></div>
    <div layout:replace="~{module/delete :: script}"></div>
    <div layout:replace="~{module/edit :: script}"></div>

</div>

</body>
</html>